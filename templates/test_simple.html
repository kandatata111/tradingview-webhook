<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>é€šè²¨å¼·å¼± ã‚·ãƒ³ãƒ—ãƒ«ãƒ†ã‚¹ãƒˆ</title>
  <style>
    body { background: #1a1a1a; color: #e0e0e0; font-family: monospace; padding: 20px; }
    .log { background: #2a2a2a; padding: 10px; margin: 10px 0; border-radius: 4px; }
    .success { color: #4ade80; }
    .error { color: #f87171; }
    .info { color: #fbbf24; }
  </style>
</head>
<body>
  <h1>ğŸ” é€šè²¨å¼·å¼± ã‚·ãƒ³ãƒ—ãƒ«ãƒ†ã‚¹ãƒˆ</h1>
  <div id="logs"></div>
  
  <script>
    const logsDiv = document.getElementById('logs');
    
    function log(message, type = 'info') {
      const logEntry = document.createElement('div');
      logEntry.className = `log ${type}`;
      logEntry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
      logsDiv.appendChild(logEntry);
      console.log(message);
    }
    
    async function runTest() {
      log('ãƒ†ã‚¹ãƒˆé–‹å§‹', 'info');
      
      try {
        // API ãƒ†ã‚¹ãƒˆ
        log('API ãƒªã‚¯ã‚¨ã‚¹ãƒˆé€ä¿¡: /api/currency_strength', 'info');
        const response = await fetch('/api/currency_strength?_=' + Date.now());
        log(`API ãƒ¬ã‚¹ãƒãƒ³ã‚¹: ${response.status} ${response.statusText}`, 'info');
        
        if (!response.ok) {
          throw new Error(`HTTP ${response.status}`);
        }
        
        const data = await response.json();
        log(`ãƒ‡ãƒ¼ã‚¿å—ä¿¡æˆåŠŸ: status=${data.status}`, 'success');
        
        if (data.data) {
          for (let tf of ['15m', '1H', '4H']) {
            if (data.data[tf]) {
              const currencies = data.data[tf].currencies;
              log(`[${tf}] é€šè²¨æ•°: ${currencies.length}`, 'success');
              if (currencies.length > 0) {
                log(`  æœ€å¼±: ${currencies[0].currency} (${currencies[0].percentage}%)`, 'info');
                log(`  æœ€å¼·: ${currencies[currencies.length-1].currency} (${currencies[currencies.length-1].percentage}%)`, 'info');
              }
            }
          }
        }
        
        log('âœ“ ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆæˆåŠŸï¼', 'success');
        
      } catch (error) {
        log(`âœ— ãƒ†ã‚¹ãƒˆå¤±æ•—: ${error.message}`, 'error');
        log(`ã‚¹ã‚¿ãƒƒã‚¯: ${error.stack}`, 'error');
      }
    }
    
    log('ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰å®Œäº†', 'success');
    runTest();
  </script>
</body>
</html>
