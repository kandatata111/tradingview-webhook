<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é€šè²¨å¼·å¼±ãƒ¡ãƒ¼ã‚¿ãƒ¼</title>
  <!-- Socket.IO CDN -->
  <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', Meiryo, sans-serif;
      background: #1a1a1a;
      color: #e0e0e0;
      padding: 6px;
      margin: 0;
    }

    .container {
      max-width: 1200px;
      margin: 0;
    }

    h1 {
      text-align: center;
      color: #06b7f9;
      margin-bottom: 20px;
      font-size: 24px;
    }

    /* é€šè²¨å¼·å¼±è¡¨ */
    .strength-table {
      background: #2a2a2a;
      border-radius: 8px;
      padding: 6px;
      border: 1px solid #444;
      margin-bottom: 0;
    }

    .strength-title {
      color: #06b7f9;
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 12px;
      padding-bottom: 8px;
      border-bottom: 2px solid #06b7f9;
    }

    /* ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
    .strength-table-wrapper {
      width: 100%;
    }

    .strength-table-grid {
      display: grid;
      grid-template-columns: 50px repeat(5, 1fr) 2fr;
      gap: 2px;
      font-family: 'Consolas', monospace;
      font-size: 14px;
      font-weight: bold;
      width: 100%;
    }

    .table-header {
      font-weight: bold;
      background: #2d68f8;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 4px;
      border: 1px solid #555;
      border-radius: 3px;
    }

    .table-header-currencies {
      font-weight: bold;
      background: #2d68f8;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 4px;
      border: 1px solid #555;
      border-radius: 3px;
      grid-column: span 5;
    }

    .table-header-recommended {
      font-weight: bold;
      background: #2d68f8;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 4px;
      border: 1px solid #555;
      border-radius: 3px;
    }

    .table-row-label {
      font-weight: bold;
      background: #2d68f8;
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      border: 1px solid #555;
      padding: 4px;
      border-radius: 3px;
    }

    .table-cell {
      border: 1px solid #fff;
      padding: 4px 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      border-radius: 3px;
      white-space: nowrap;
    }

    .table-cell.very-weak { background: #d32f2f; color: #fff; }
    .table-cell.weak { background: #f57c00; color: #fff; }
    .table-cell.neutral { background: #616161; color: #fff; }
    .table-cell.strong { background: #388e3c; color: #fff; }
    .table-cell.very-strong { background: #1976d2; color: #fff; }

    .table-recommended {
      border: 1px solid #555;
      padding: 4px 6px;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      gap: 12px;
      flex-wrap: nowrap;
    }

    .recommended-pair {
      display: flex;
      align-items: center;
      gap: 3px;
      font-size: 14px;
      white-space: nowrap;
    }

    .buy-badge {
      background: #1976d2;
      color: #fff;
      padding: 2px 5px;
      border-radius: 3px;
      font-weight: bold;
      font-size: 14px;
    }

    .sell-badge {
      background: #ff57ea;
      color: #fff;
      padding: 2px 5px;
      border-radius: 3px;
      font-weight: bold;
      font-size: 14px;
    }

    /* æ¨å¥¨ãƒšã‚¢ */
    .recommended {
      display: none;
    }

    /* é€šè²¨è‰²åˆ†ã‘ */
    .very-weak { background: #d32f2f; color: #fff; }
    .weak { background: #f57c00; color: #fff; }
    .neutral { background: #616161; color: #fff; }
    .strong { background: #388e3c; color: #fff; }
    .very-strong { background: #1976d2; color: #fff; }

    /* ã‚¿ãƒ–ã‚¹ã‚¿ã‚¤ãƒ« */
    .tab-container {
      background: #1a1a1a;
      border-radius: 8px;
      margin-top: 20px;
    }
    
    .tab-headers {
      display: flex;
      gap: 4px;
      background: #2a2a2a;
      padding: 8px;
      border-radius: 8px 8px 0 0;
      border-bottom: 2px solid #444;
    }
    
    .tab-header {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px 20px;
      cursor: pointer;
      background: #333;
      border-radius: 6px 6px 0 0;
      font-size: 15px;
      font-weight: 500;
      color: #999;
      transition: all 0.2s;
      border: none;
      border-bottom: 3px solid transparent;
    }
    
    .tab-header:hover {
      background: #3a3a3a;
      color: #ccc;
    }
    
    .tab-header.active {
      background: #2d68f8;
      color: #fff;
      border-bottom-color: #2d68f8;
    }
    
    .tab-icon {
      font-size: 18px;
    }
    
    .tab-content {
      display: none;
      padding: 0;
      background: #1e1e1e;
      border-radius: 0 0 8px 8px;
    }
    
    .tab-content.active {
      display: block;
      padding: 20px;
    }

    /* ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ï¼ˆæ—§ã‚¹ã‚¿ã‚¤ãƒ« - æœªä½¿ç”¨ï¼‰ */
    .accordion {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 10px;
    }

    .accordion-item {
      background: #2a2a2a;
      border-radius: 8px;
      border: 1px solid #444;
      overflow: hidden;
    }

    .accordion-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 20px;
      cursor: pointer;
      background: linear-gradient(90deg, #2a2a2a, #252525);
      transition: background 0.3s;
      user-select: none;
    }

    .accordion-header:hover {
      background: linear-gradient(90deg, #333, #2a2a2a);
    }

    .accordion-header.active {
      background: linear-gradient(90deg, #2d68f8, #1e4fcc);
    }

    .accordion-title {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 15px;
      font-weight: bold;
      color: #e0e0e0;
    }

    .accordion-header.active .accordion-title {
      color: #fff;
    }

    .accordion-icon {
      font-size: 20px;
    }

    .accordion-arrow {
      font-size: 18px;
      transition: transform 0.3s;
    }

    .accordion-header.active .accordion-arrow {
      transform: rotate(180deg);
    }

    .accordion-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s ease-out, padding 0.4s ease-out;
      padding: 0 20px;
    }

    .accordion-content.active {
      max-height: 1000px;
      padding: 20px;
      border-top: 2px solid #444;
    }

    /* ãƒ•ã‚©ãƒ¼ãƒ è¦ç´  */
    .form-section {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .form-row {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .form-row label {
      font-size: 13px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .checkbox-item {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
    }

    .checkbox-item input[type="checkbox"] {
      cursor: pointer;
      width: 18px;
      height: 18px;
    }

    .checkbox-item label {
      cursor: pointer;
    }

    select, input[type="text"] {
      padding: 8px 12px;
      background: #333;
      color: #fff;
      border: 1px solid #666;
      border-radius: 4px;
      font-size: 13px;
    }

    button {
      padding: 8px 16px;
      background: #2d68f8;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 13px;
      font-weight: bold;
      transition: background 0.3s;
      white-space: nowrap;
    }

    button:hover {
      background: #4080ff;
    }

    /* éŸ³å£°è¨­å®šã®1è¡Œãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
    .voice-timeframe {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
    }

    .voice-timeframe input[type="checkbox"] {
      width: 18px;
      height: 18px;
      cursor: pointer;
    }

    .voice-timeframe label {
      min-width: 80px;
      font-weight: bold;
    }

    .voice-timeframe input[type="text"] {
      flex: 1;
    }

    /* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚°ãƒªãƒƒãƒ‰ */
    .checkbox-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 8px;
    }

    .subsection-title {
      color: #06b7f9;
      font-size: 13px;
      font-weight: bold;
      margin: 16px 0 8px;
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- é€šè²¨å¼·å¼± + æ¨å¥¨ãƒšã‚¢ -->
    <div class="strength-table" id="strengthTableContainer" style="transform-origin: top left; transition: transform 0.2s ease;">
      <div class="strength-title">
        é€šè²¨å¼·å¼±ãƒ©ãƒ³ã‚­ãƒ³ã‚° + æ¨å¥¨ãƒšã‚¢ 
        <span id="loadingText" style="color:#ffd700;font-size:14px;margin-left:10px;">èª­ã¿è¾¼ã¿ä¸­...</span>
        <span id="updateTime" style="color:#fff;font-size:12px;margin-left:10px;"></span>
        <span id="serverVersion" style="color:#888;font-size:11px;margin-left:15px;"></span>
      </div>
      
      <div id="strengthData">
        <!-- JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
      </div>
    </div>

    <!-- è¨­å®šé …ç›® -->
    <div class="tab-container" id="settingsContainer" style="transform-origin: top left; transition: transform 0.2s ease;">
      <!-- ã‚¿ãƒ–ãƒ˜ãƒƒãƒ€ãƒ¼ -->
      <div class="tab-headers">
        <button class="tab-header" data-tab="history">
          <span class="tab-icon">ğŸ“œ</span>
          <span>æœ€å¼·ãƒ»æœ€å¼±å¤‰æ›´å±¥æ­´</span>
        </button>
        <button class="tab-header" data-tab="display">
          <span class="tab-icon">ğŸ“Š</span>
          <span>è¡¨ç¤ºè¨­å®š</span>
        </button>
        <button class="tab-header" data-tab="voice">
          <span class="tab-icon">ğŸ”Š</span>
          <span>éŸ³å£°é€šçŸ¥è¨­å®š</span>
        </button>
        <button class="tab-header" data-tab="save">
          <span class="tab-icon">ğŸ’¾</span>
          <span>è¨­å®šä¿å­˜</span>
        </button>
      </div>

      <!-- ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
      <!-- æœ€å¼·ãƒ»æœ€å¼±å¤‰æ›´å±¥æ­´ -->
      <div class="tab-content" data-tab-content="history">
        <div id="changeHistory" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
          <!-- JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
        </div>
      </div>

      <!-- è¡¨ç¤ºè¨­å®š -->
      <div class="tab-content" data-tab-content="display">
        <div class="form-section">
            <div style="display: grid; grid-template-columns: 1fr auto; gap: 20px; align-items: start;">
              <div>
                <div class="subsection-title">è¡¨ç¤ºé …ç›®</div>
                <div style="display: flex; gap: 20px; margin-bottom: 16px;">
                  <label class="checkbox-item">
                    <input type="checkbox" id="showCurrencies" checked>
                    é€šè²¨å¼·å¼±ã‚’è¡¨ç¤º
                  </label>
                  <label class="checkbox-item">
                    <input type="checkbox" id="showRecommended" checked>
                    æ¨å¥¨ãƒšã‚¢ã‚’è¡¨ç¤º
                  </label>
                </div>
              </div>
              <div>
                <div class="subsection-title">ã‚ºãƒ¼ãƒ å€ç‡</div>
                <select id="zoomLevel">
                  <option value="50">50%</option>
                  <option value="60">60%</option>
                  <option value="70">70%</option>
                  <option value="80">80%</option>
                  <option value="90">90%</option>
                  <option value="100" selected>100%</option>
                  <option value="110">110%</option>
                  <option value="120">120%</option>
                  <option value="130">130%</option>
                  <option value="140">140%</option>
                  <option value="150">150%</option>
                </select>
              </div>
            </div>

            <div class="subsection-title">é€šè²¨åè¡¨ç¤ºè¨€èª</div>
            <div style="display: flex; gap: 20px; margin-bottom: 16px;">
              <label class="checkbox-item">
                <input type="radio" name="currencyLang" id="langEn" value="en" checked>
                è‹±èªï¼ˆUSD / JPYï¼‰
              </label>
              <label class="checkbox-item">
                <input type="radio" name="currencyLang" id="langJa" value="ja">
                æ—¥æœ¬èªï¼ˆç±³ãƒ‰ãƒ« / æ—¥æœ¬å††ï¼‰
              </label>
            </div>

            <div class="subsection-title">æ™‚é–“è¶³</div>
            <div style="display: flex; gap: 20px; flex-wrap: wrap;">
              <label class="checkbox-item">
                <input type="checkbox" id="show15m" checked>
                15åˆ†è¶³
              </label>
              <label class="checkbox-item">
                <input type="checkbox" id="show1H" checked>
                1æ™‚é–“è¶³
              </label>
              <label class="checkbox-item">
                <input type="checkbox" id="show4H" checked>
                4æ™‚é–“è¶³
              </label>
              <label class="checkbox-item">
                <input type="checkbox" id="showD" checked>
                æ—¥è¶³
              </label>
              <label class="checkbox-item">
                <input type="checkbox" id="showAv" checked>
                å¹³å‡
              </label>
            </div>

            <!-- æ­£è¦åŒ– / ã‚¯ãƒªãƒƒãƒ—è¨­å®š -->
            <div style="margin-top:16px;border-top:1px dashed #333;padding-top:12px;">
              <div class="subsection-title">æ­£è¦åŒ– / ã‚¯ãƒªãƒƒãƒ—è¨­å®š</div>
              <div style="display:flex;gap:16px;align-items:center;flex-wrap:wrap;">
                <div style="display:flex;flex-direction:column;gap:6px;min-width:220px;">
                  <label>é€šè²¨å¼·å¼±æ­£è¦åŒ– (ç†è«–Max: 400)</label>
                  <div style="display:flex;gap:8px;align-items:center;">
                    <input id="currencyNormBase" type="number" min="1" max="400" value="350" style="width:100px;padding:6px;background:#111;color:#ddd;border:1px solid #333;border-radius:4px;">
                    <small style="color:#94a3b8;">(è¡¨ç¤ºåŸºæº– â€” é€šè²¨ã®ç”Ÿã‚¹ã‚³ã‚¢ã‚’ã“ã®å€¤ã§å‰²ã£ã¦%ç®—å‡º)</small>
                  </div>
                </div>

                <div style="display:flex;flex-direction:column;gap:6px;min-width:220px;">
                  <label>æ¨å¥¨ãƒšã‚¢æ­£è¦åŒ– (ç†è«–Max: 800)</label>
                  <div style="display:flex;gap:8px;align-items:center;">
                    <input id="pairNormBase" type="number" min="1" max="800" value="700" style="width:100px;padding:6px;background:#111;color:#ddd;border:1px solid #333;border-radius:4px;">
                    <small style="color:#94a3b8;">(pair_score ã‚’ã“ã®å€¤ã§å‰²ã£ã¦%ç®—å‡º)</small>
                  </div>
                </div>

                <div style="display:flex;align-items:center;gap:8px;min-width:320px;">
                  <input type="checkbox" id="clipEnabled" checked>
                  <label style="font-size:0.95em;">ç”Ÿã‚¹ã‚³ã‚¢ãŒ&nbsp;<input id="clipThreshold" type="number" min="1" max="400" value="350" style="width:80px;padding:6px;background:#111;color:#ddd;border:1px solid #333;border-radius:4px;display:inline-block;margin-left:6px;"> ã‚’è¶…ãˆã‚‹å ´åˆã¯ <strong>100%</strong> ã§ã‚¯ãƒªãƒƒãƒ—ï¼ˆè¡¨ç¤ºä¸Šï¼‰</label>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- éŸ³å£°é€šçŸ¥è¨­å®š -->
      <div class="tab-content" data-tab-content="voice">
        <div class="form-section">
            <div class="form-row">
              <label style="min-width: 100px;">å£°å„ªé¸æŠï¼š</label>
              <select id="voiceActress">
                <option value="nanami">ä¸ƒæµ·ï¼ˆå¥³æ€§ï¼‰</option>
                <option value="keita">åœ­å¤ªï¼ˆç”·æ€§ï¼‰</option>
              </select>
            </div>
            <div class="form-row">
              <input type="checkbox" id="enableElectronic">
              <label>é›»å­éŸ³ã‚’æœ‰åŠ¹åŒ–</label>
              <select id="electronicSound" style="margin-left: 12px;" disabled>
                <option value="">ãªã—</option>
              </select>
            </div>

            <div class="subsection-title">æ™‚é–“è¶³åˆ¥é€šçŸ¥è¨­å®š</div>
            
            <div class="voice-timeframe">
              <input type="checkbox" id="notify15m" checked>
              <label for="notify15m">15åˆ†è¶³</label>
              <input type="text" id="msg15m" placeholder="é€šçŸ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸">
              <button id="play15m">â–¶ å†ç”Ÿ</button>
            </div>

            <div class="voice-timeframe">
              <input type="checkbox" id="notify1H" checked>
              <label for="notify1H">1æ™‚é–“è¶³</label>
              <input type="text" id="msg1H" placeholder="é€šçŸ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸">
              <button id="play1H">â–¶ å†ç”Ÿ</button>
            </div>

            <div class="voice-timeframe">
              <input type="checkbox" id="notify4H" checked>
              <label for="notify4H">4æ™‚é–“è¶³</label>
              <input type="text" id="msg4H" placeholder="é€šçŸ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸">
              <button id="play4H">â–¶ å†ç”Ÿ</button>
            </div>
          </div>
        </div>
      </div>

      <!-- è¨­å®šä¿å­˜ -->
      <div class="tab-content" data-tab-content="save">
        <button id="saveSettings" style="width:100%;padding:12px;font-size:15px;">ğŸ’¾ è¨­å®šã‚’ä¿å­˜</button>
        <div id="saveMessage" style="margin-top:12px;text-align:center;color:#28a745;display:none;font-weight:bold;">âœ“ è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ</div>
      </div>
    </div>
  </div>

  <script>
    // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½
    function switchTab(tabName) {
      console.log('[TAB] switchTab called with:', tabName);
      
      // å…¨ã¦ã®ã‚¿ãƒ–ãƒ˜ãƒƒãƒ€ãƒ¼ã¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‹ã‚‰ active ã‚’å‰Šé™¤
      document.querySelectorAll('.tab-header').forEach(header => {
        header.classList.remove('active');
      });
      document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
      });
      
      // ã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã‚¿ãƒ–ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«
      if (tabName) {
        const header = document.querySelector(`.tab-header[data-tab="${tabName}"]`);
        const content = document.querySelector(`.tab-content[data-tab-content="${tabName}"]`);
        
        if (header && content) {
          console.log('[TAB] Activating tab:', tabName);
          header.classList.add('active');
          content.classList.add('active');
        } else {
          console.log('[TAB] Tab not found:', tabName);
        }
      } else {
        console.log('[TAB] All tabs closed');
      }
    }
    
    // ã‚¿ãƒ–ãƒ˜ãƒƒãƒ€ãƒ¼ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
    document.addEventListener('DOMContentLoaded', () => {
      // åˆæœŸåŒ–ï¼šå…¨ã¦ã®ã‚¿ãƒ–ã‚’é–‰ã˜ã‚‹
      console.log('[TAB] Initializing tabs - closing all');
      switchTab(null);
      
      // ã‚¿ãƒ–ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¨­å®š
      document.querySelectorAll('.tab-header').forEach(header => {
        header.addEventListener('click', () => {
          const tabName = header.getAttribute('data-tab');
          const isActive = header.classList.contains('active');
          
          console.log('[TAB] Clicked:', tabName, 'isActive:', isActive);
          
          // æ—¢ã«ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚¿ãƒ–ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã‚‰é–‰ã˜ã‚‹
          if (isActive) {
            switchTab(null); // å…¨ã¦é–‰ã˜ã‚‹
          } else {
            switchTab(tabName);
          }
        });
      });
    });

    // è¨­å®šã®ä¿å­˜ã‚­ãƒ¼
    const STORAGE_KEY_VOICE_SETTINGS = 'currencyStrengthVoiceSettings';
    const STORAGE_KEY_ZOOM = 'currencyStrengthZoom';
    const STORAGE_KEY_DISPLAY_SETTINGS = 'currencyStrengthDisplaySettings';
    
    // å¤‰æ›´å±¥æ­´ã‚’è¡¨ç¤ºï¼ˆã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰å–å¾—ï¼‰
    async function renderChangeHistory() {
      const container = document.getElementById('changeHistory');
      if (!container) return;
      
      try {
        // ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰å¤‰æ›´å±¥æ­´ã‚’å–å¾—
        const response = await fetch('/api/change_history?limit=5');
        const result = await response.json();
        
        if (result.status !== 'success') {
          console.error('[HISTORY] Failed to fetch history:', result.msg);
          container.innerHTML = '<div style="color: #f44; padding: 12px;">å±¥æ­´ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ</div>';
          return;
        }
        
        const history = result.data;
        
        // æ™‚é–“è¶³ãƒªã‚¹ãƒˆ
        const timeframes = [
          { key: '15m', label: '15åˆ†è¶³' },
          { key: '1H', label: '1æ™‚é–“è¶³' },
          { key: '4H', label: '4æ™‚é–“è¶³' },
          { key: 'D', label: 'æ—¥è¶³' },
          { key: 'Av', label: 'å¹³å‡' }
        ];
        
        let html = '';
        
        timeframes.forEach(tf => {
          const records = history[tf.key] || [];
          
          html += `
            <div style="background: #222; padding: 12px; border-radius: 6px; border-left: 3px solid #2d68f8;">
              <div style="color: #06b7f9; font-weight: bold; margin-bottom: 8px;">${tf.label}ã€€å¼±â‡”å¼·</div>
              <div style="font-size: 12px; font-family: 'Consolas', monospace;">
          `;
          
          if (records.length === 0) {
            html += `<div style="color: #666;">å¤‰æ›´å±¥æ­´ãªã—</div>`;
          } else {
            records.forEach(record => {
              const weakestPercent = record.weakest_percent !== undefined ? record.weakest_percent : 0;
              const strongestPercent = record.strongest_percent !== undefined ? record.strongest_percent : 0;
              const weakestSign = weakestPercent >= 0 ? '+' : '';
              const strongestSign = strongestPercent >= 0 ? '+' : '';
              html += `<div style="margin-bottom: 4px;">${record.timestamp}ã€€${record.weakest}${weakestSign}${weakestPercent}%â‡”${record.strongest}${strongestSign}${strongestPercent}%</div>`;
            });
          }
          
          html += `
              </div>
            </div>
          `;
        });
        
        container.innerHTML = html;
        
        console.log('[HISTORY] Rendered change history from server');
      } catch (e) {
        console.error('[HISTORY] Failed to render history:', e);
        container.innerHTML = '<div style="color: #f44; padding: 12px;">å±¥æ­´ã®è¡¨ç¤ºã«å¤±æ•—ã—ã¾ã—ãŸ</div>';
      }
    }
    
    // è¨­å®šã‚’ä¿å­˜
    function saveSettings() {
      try {
        // éŸ³å£°é€šçŸ¥è¨­å®šã‚’ä¿å­˜
        const settings = {
          voiceActress: voiceNotificationSettings.voiceActress,
          enableElectronic: voiceNotificationSettings.enableElectronic,
          electronicSound: voiceNotificationSettings.electronicSound,
          notify: voiceNotificationSettings.notify,
          customMessages: voiceNotificationSettings.customMessages
        };
        localStorage.setItem(STORAGE_KEY_VOICE_SETTINGS, JSON.stringify(settings));
        
        // è¡¨ç¤ºè¨­å®šï¼ˆpersist displaySettings subsetï¼‰
        const displayPrefs = {
          showCurrencies: displaySettings.showCurrencies,
          showRecommended: displaySettings.showRecommended,
          show15m: displaySettings.show15m,
          show1H: displaySettings.show1H,
          show4H: displaySettings.show4H,
          showD: displaySettings.showD,
          showAv: displaySettings.showAv,
          currencyNormalizationBase: displaySettings.currencyNormalizationBase,
          pairNormalizationBase: displaySettings.pairNormalizationBase,
          clipEnabled: displaySettings.clipEnabled,
          clipThreshold: displaySettings.clipThreshold,
          language: displaySettings.language
        };
        localStorage.setItem(STORAGE_KEY_DISPLAY_SETTINGS, JSON.stringify(displayPrefs));

        // ã‚ºãƒ¼ãƒ è¨­å®šã‚’ä¿å­˜
        const zoomLevel = document.getElementById('zoomLevel').value;
        localStorage.setItem(STORAGE_KEY_ZOOM, zoomLevel);
        
        // ä¿å­˜æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
        const saveMsg = document.getElementById('saveMessage');
        saveMsg.style.display = 'block';
        setTimeout(() => {
          saveMsg.style.display = 'none';
        }, 2000);
        
        console.log('[SAVE] è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ãŸ:', settings, 'displayPrefs:', displayPrefs, 'zoom:', zoomLevel);
      } catch (e) {
        console.error('[SAVE] è¨­å®šã®ä¿å­˜ã«å¤±æ•—:', e);
        alert('è¨­å®šã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ');
      }
    }
    
    // è¨­å®šã‚’èª­ã¿è¾¼ã¿
    function loadSettings() {
      try {
        // éŸ³å£°é€šçŸ¥è¨­å®šã‚’èª­ã¿è¾¼ã¿
        const savedSettings = localStorage.getItem(STORAGE_KEY_VOICE_SETTINGS);
        if (savedSettings) {
          const settings = JSON.parse(savedSettings);
          console.log('[LOAD] ä¿å­˜ã•ã‚ŒãŸè¨­å®šã‚’èª­ã¿è¾¼ã¿:', settings);
          
          // è¨­å®šã‚’å¾©å…ƒ
          document.getElementById('voiceActress').value = settings.voiceActress || 'nanami';
          voiceNotificationSettings.voiceActress = settings.voiceActress || 'nanami';
          
          document.getElementById('enableElectronic').checked = settings.enableElectronic || false;
          voiceNotificationSettings.enableElectronic = settings.enableElectronic || false;
          
          const soundSelect = document.getElementById('electronicSound');
          soundSelect.value = settings.electronicSound || '';
          soundSelect.disabled = !settings.enableElectronic;
          voiceNotificationSettings.electronicSound = settings.electronicSound || '';
          
          // å„æ™‚é–“è¶³ã®è¨­å®šã‚’å¾©å…ƒ
          ['15m', '1H', '4H'].forEach(tf => {
            if (settings.notify && settings.notify[tf] !== undefined) {
              document.getElementById(`notify${tf}`).checked = settings.notify[tf];
              voiceNotificationSettings.notify[tf] = settings.notify[tf];
            }
            if (settings.customMessages && settings.customMessages[tf]) {
              document.getElementById(`msg${tf}`).value = settings.customMessages[tf];
              voiceNotificationSettings.customMessages[tf] = settings.customMessages[tf];
            }
          });
        }

        // è¡¨ç¤ºè¨­å®šã‚’èª­ã¿è¾¼ã¿
        try {
          const savedDisplay = localStorage.getItem(STORAGE_KEY_DISPLAY_SETTINGS);
          if (savedDisplay) {
            const dsp = JSON.parse(savedDisplay);
            console.log('[LOAD] è¡¨ç¤ºè¨­å®šã‚’èª­ã¿è¾¼ã¿:', dsp);

            // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹é¡
            ['showCurrencies','showRecommended','show15m','show1H','show4H','showD','showAv'].forEach(id => {
              if (dsp[id] !== undefined) {
                document.getElementById(id).checked = dsp[id];
                displaySettings[id] = dsp[id];
              }
            });

            // æ­£è¦åŒ–ï¼ã‚¯ãƒªãƒƒãƒ—
            if (dsp.currencyNormalizationBase) {
              document.getElementById('currencyNormBase').value = dsp.currencyNormalizationBase;
              displaySettings.currencyNormalizationBase = dsp.currencyNormalizationBase;
            }
            if (dsp.pairNormalizationBase) {
              document.getElementById('pairNormBase').value = dsp.pairNormalizationBase;
              displaySettings.pairNormalizationBase = dsp.pairNormalizationBase;
            }
            if (dsp.clipEnabled !== undefined) {
              document.getElementById('clipEnabled').checked = dsp.clipEnabled;
              displaySettings.clipEnabled = dsp.clipEnabled;
            }
            if (dsp.clipThreshold) {
              document.getElementById('clipThreshold').value = dsp.clipThreshold;
              displaySettings.clipThreshold = dsp.clipThreshold;
            }
            if (dsp.language) {
              displaySettings.language = dsp.language;
              const radioId = dsp.language === 'ja' ? 'langJa' : 'langEn';
              const radio = document.getElementById(radioId);
              if (radio) radio.checked = true;
            }
          }
        } catch (e) {
          console.warn('[LOAD] è¡¨ç¤ºè¨­å®šã®å¾©å…ƒã«å¤±æ•—:', e);
        }
        
        // ã‚ºãƒ¼ãƒ è¨­å®šã‚’èª­ã¿è¾¼ã¿
        const savedZoom = localStorage.getItem(STORAGE_KEY_ZOOM);
        if (savedZoom) {
          document.getElementById('zoomLevel').value = savedZoom;
          applyZoom(savedZoom);
          console.log('[LOAD] ã‚ºãƒ¼ãƒ è¨­å®šã‚’å¾©å…ƒ:', savedZoom + '%');
        }
      } catch (e) {
        console.error('[LOAD] è¨­å®šã®èª­ã¿è¾¼ã¿ã«å¤±æ•—:', e);
      }
    }
    
    // ã‚ºãƒ¼ãƒ ã‚’é©ç”¨
    function applyZoom(level) {
      const strengthContainer = document.getElementById('strengthTableContainer');
      const settingsContainer = document.getElementById('settingsContainer');
      const scale = level / 100;
      
      if (strengthContainer) {
        strengthContainer.style.transform = `scale(${scale})`;
      }
      if (settingsContainer) {
        settingsContainer.style.transform = `scale(${scale})`;
      }
      
      console.log('[ZOOM] ã‚ºãƒ¼ãƒ ã‚’é©ç”¨:', level + '%', 'scale:', scale);
    }
    
    // Web Speech API ã®éŸ³å£°ãƒªã‚¹ãƒˆã‚’èª­ã¿è¾¼ã‚€
    let voicesLoaded = false;
    
    function loadVoices() {
      const voices = speechSynthesis.getVoices();
      if (voices.length > 0) {
        voicesLoaded = true;
        console.log(`[VOICE_INIT] éŸ³å£°ãƒªã‚¹ãƒˆèª­ã¿è¾¼ã¿å®Œäº†: ${voices.length} voices`);
        // æ—¥æœ¬èªéŸ³å£°ã‚’ãƒªã‚¹ãƒˆè¡¨ç¤ºï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰
        const jaVoices = voices.filter(v => v.lang.startsWith('ja'));
        console.log(`[VOICE_INIT] æ—¥æœ¬èªéŸ³å£°æ•°: ${jaVoices.length}`);
        jaVoices.forEach((v, i) => {
          const actualIndex = voices.indexOf(v);
          console.log(`[VOICE_INIT]   [${actualIndex}] ${v.name} (${v.lang})`);
        });
      }
    }
    
    // éŸ³å£°ãƒªã‚¹ãƒˆã®èª­ã¿è¾¼ã¿ã‚’å¾…ã¤
    if (speechSynthesis.onvoiceschanged !== undefined) {
      speechSynthesis.onvoiceschanged = loadVoices;
    }
    loadVoices(); // å³åº§ã«è©¦è¡Œ
    
    // é›»å­éŸ³ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆã‚’å–å¾—ã—ã¦è¡¨ç¤º
    async function populateChimeFiles() {
      const select = document.getElementById('electronicSound');
      console.log('[CHIME] Populating chime files...');
      try {
        const response = await fetch('/api/chime_files');
        if (response.ok) {
          const data = await response.json();
          console.log('[CHIME] Chime files response:', data);
          if (data.status === 'success' && data.files) {
            // æ—¢å­˜ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã‚¯ãƒªã‚¢ï¼ˆã€Œãªã—ã€ä»¥å¤–ï¼‰
            select.innerHTML = '<option value="">ãªã—</option>';
            
            data.files.forEach(file => {
              const option = document.createElement('option');
              option.value = file;
              option.textContent = file.replace('.mp3', '').replace('.wav', '').replace('.ogg', '');
              select.appendChild(option);
            });
            console.log('[CHIME] Added', data.files.length, 'chime files to select');
          }
        }
      } catch (e) {
        console.error('[CHIME] Error fetching chime files:', e);
      }
    }
    
    // é›»å­éŸ³ã‚’å†ç”Ÿ
    function playChimeSound(onComplete) {
      if (!voiceNotificationSettings.enableElectronic || !voiceNotificationSettings.electronicSound) {
        console.log('[CHIME] Chime not enabled or file not set');
        if (onComplete) onComplete();
        return;
      }
      
      try {
        const audioPath = `/Alarm/${voiceNotificationSettings.electronicSound}`;
        console.log('[CHIME] Playing chime from:', audioPath);
        const audio = new Audio(audioPath);
        audio.volume = 0.8;
        
        audio.addEventListener('ended', () => {
          console.log('[CHIME] Chime playback completed');
          if (onComplete) onComplete();
        });
        
        audio.addEventListener('error', (err) => {
          console.error('[CHIME] Chime playback error:', err);
          if (onComplete) onComplete();
        });
        
        audio.play().then(() => {
          console.log('[CHIME] Chime playback started successfully');
        }).catch(err => {
          console.error('[CHIME] Failed to play chime:', err);
          if (onComplete) onComplete();
        });
      } catch (e) {
        console.error('[CHIME] Error playing chime:', e);
        if (onComplete) onComplete();
      }
    }
    
    // è¡¨ç¤ºè¨­å®š
    const displaySettings = {
      showCurrencies: true,
      showRecommended: true,
      show15m: true,
      show1H: true,
      show4H: true,
      showD: true,
      showAv: true,
      // é€šè²¨åè¡¨ç¤ºè¨€èª: 'en' or 'ja'
      language: 'en',
      // æ­£è¦åŒ–ï¼è¡¨ç¤ºã‚¹ã‚±ãƒ¼ãƒ«ï¼ˆUIã‹ã‚‰å¤‰æ›´å¯èƒ½ï¼‰
      // é€šè²¨ã¯ç†è«–Max=400ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¡¨ç¤ºåŸºæº–=350ï¼‰
      currencyNormalizationBase: 350,
      currencyMaxTheoretical: 400,
      // æ¨å¥¨ãƒšã‚¢ã¯ç†è«–Max=800ï¼ˆUIãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ=700ï¼‰
      pairNormalizationBase: 700,
      pairMaxTheoretical: 800,
      // ç”Ÿã‚¹ã‚³ã‚¢ãŒ clipThreshold ã‚’è¶…ãˆãŸã‚‰ 100% ã§ã‚¯ãƒªãƒƒãƒ—ï¼ˆè¡¨ç¤ºä¸Šï¼‰
      clipEnabled: true,
      clipThreshold: 350
    };

    // é€šè²¨åãƒãƒƒãƒ”ãƒ³ã‚°ï¼ˆè‹±èªâ‡”æ—¥æœ¬èªï¼‰
    const CURRENCY_NAMES = {
      en: { GBP: 'GBP', EUR: 'EUR', AUD: 'AUD', USD: 'USD', JPY: 'JPY' },
      ja: { GBP: 'ãƒãƒ³ãƒ‰', EUR: 'ãƒ¦ãƒ¼ãƒ­', AUD: 'è±ªãƒ‰ãƒ«', USD: 'ç±³ãƒ‰ãƒ«', JPY: 'æ—¥æœ¬å††' }
    };

    function getCurrencyLabel(code) {
      return (CURRENCY_NAMES[displaySettings.language] || CURRENCY_NAMES.en)[code] || code;
    }

    function getPairLabel(base, quote) {
      return `${getCurrencyLabel(base)}/${getCurrencyLabel(quote)}`;
    }
    
    // éŸ³å£°é€šçŸ¥è¨­å®š
    const voiceNotificationSettings = {
      voiceActress: 'nanami',
      enableElectronic: false,
      electronicSound: '',
      notify: {
        '15m': true,
        '1H': true,
        '4H': true
      },
      customMessages: {
        '15m': '15åˆ†è¶³ã§æœ€å¼±ãƒ»æœ€å¼·ãŒå¤‰æ›´ã«ãªã‚Šã¾ã—ãŸ',
        '1H': '1æ™‚é–“è¶³ã§æœ€å¼±ãƒ»æœ€å¼·ãŒå¤‰æ›´ã«ãªã‚Šã¾ã—ãŸ',
        '4H': '4æ™‚é–“è¶³ã§æœ€å¼±ãƒ»æœ€å¼·ãŒå¤‰æ›´ã«ãªã‚Šã¾ã—ãŸ'
      }
    };
    
    // å‰å›ã®æœ€å¼±ãƒ»æœ€å¼·ã‚’ä¿å­˜
    let previousExtreme = {
      '15m': { weakest: null, strongest: null },
      '1H': { weakest: null, strongest: null },
      '4H': { weakest: null, strongest: null },
      'D': { weakest: null, strongest: null },
      'Av': { weakest: null, strongest: null }
    };
    
    // é›»å­éŸ³é¸æŠã®ãƒˆã‚°ãƒ«
    document.getElementById('enableElectronic').addEventListener('change', (e) => {
      voiceNotificationSettings.enableElectronic = e.target.checked;
      document.getElementById('electronicSound').disabled = !e.target.checked;
    });
    
    // å£°å„ªé¸æŠ
    document.getElementById('voiceActress').addEventListener('change', (e) => {
      voiceNotificationSettings.voiceActress = e.target.value;
    });
    
    // é›»å­éŸ³é¸æŠ
    document.getElementById('electronicSound').addEventListener('change', (e) => {
      voiceNotificationSettings.electronicSound = e.target.value;
    });
    
    // é€šçŸ¥æœ‰åŠ¹åŒ–ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹
    ['15m', '1H', '4H'].forEach(tf => {
      const checkbox = document.getElementById(`notify${tf}`);
      if (checkbox) {
        checkbox.addEventListener('change', (e) => {
          voiceNotificationSettings.notify[tf] = e.target.checked;
        });
      }
      
      // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å…¥åŠ›
      const msgInput = document.getElementById(`msg${tf}`);
      if (msgInput) {
        msgInput.addEventListener('input', (e) => {
          voiceNotificationSettings.customMessages[tf] = e.target.value;
        });
      }
    });
    
    // å†ç”Ÿãƒœã‚¿ãƒ³ã®å‡¦ç†
    console.log('[VOICE_SETUP] Setting up play button listeners...');
    ['15m', '1H', '4H'].forEach(tf => {
      const playBtn = document.getElementById(`play${tf}`);
      console.log(`[VOICE_SETUP] play${tf} button:`, playBtn);
      if (playBtn) {
        playBtn.addEventListener('click', () => {
          console.log(`[VOICE_SETUP] Play button clicked for ${tf}`);
          const msgInput = document.getElementById(`msg${tf}`);
          const message = msgInput ? (msgInput.value || voiceNotificationSettings.customMessages[tf]) : `${tf}è¶³ã§æœ€å¼±ãƒ»æœ€å¼·ãŒå¤‰æ›´ã«ãªã‚Šã¾ã—ãŸ`;
          console.log(`[VOICE_SETUP] Message:`, message);
          playNotificationSound(tf, message);
        });
        console.log(`[VOICE_SETUP] âœ“ Listener attached to play${tf}`);
      } else {
        console.error(`[VOICE_SETUP] âœ— Button play${tf} not found!`);
      }
    });
    console.log('[VOICE_SETUP] Play button setup complete');
    
    // éŸ³å£°é€šçŸ¥ã‚’å†ç”Ÿï¼ˆWeb Speech API ã‚’ä½¿ç”¨ï¼‰
    function playNotificationSound(timeframe, message) {
      try {
        console.log(`[playNotificationSound] ãƒªã‚¯ã‚¨ã‚¹ãƒˆ: timeframe=${timeframe}, message="${message}"`);
        
        // é›»å­éŸ³ã‚’å…ˆã«å†ç”Ÿã—ã€å®Œäº†å¾Œã«éŸ³å£°ã‚’ç™ºå£°
        playChimeSound(() => {
          console.log('[playNotificationSound] Chime completed, now playing voice');
          playVoiceMessage(message);
        });
        
      } catch (e) {
        console.error('[playNotificationSound] éŸ³å£°é€šçŸ¥ã‚¨ãƒ©ãƒ¼:', e);
        console.error('[playNotificationSound] Stack:', e.stack);
        alert('éŸ³å£°ã®å†ç”Ÿã«å¤±æ•—ã—ã¾ã—ãŸ: ' + e.message);
      }
    }
    
    // éŸ³å£°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å†ç”Ÿ
    function playVoiceMessage(message) {
      try {
        // Web Speech API ã‚’ä½¿ç”¨
        const utterance = new SpeechSynthesisUtterance(message);
        utterance.lang = 'ja-JP';
        
        // å£°å„ªé¸æŠï¼ˆ369: ä¸ƒæµ·ï¼ˆå¥³æ€§ï¼‰, 370: åœ­å¤ªï¼ˆç”·æ€§ï¼‰ï¼‰
        const voiceIndex = voiceNotificationSettings.voiceActress === 'keita' ? 370 : 369;
        const voices = speechSynthesis.getVoices();
        
        console.log(`[playVoiceMessage] åˆ©ç”¨å¯èƒ½ãªéŸ³å£°æ•°: ${voices.length}`);
        console.log(`[playVoiceMessage] é¸æŠã•ã‚ŒãŸå£°å„ª: ${voiceNotificationSettings.voiceActress} (index: ${voiceIndex})`);
        
        if (voices.length > voiceIndex) {
          utterance.voice = voices[voiceIndex];
          console.log(`[playVoiceMessage] éŸ³å£°è¨­å®š: ${voices[voiceIndex].name}`);
        } else {
          console.warn(`[playVoiceMessage] æŒ‡å®šã•ã‚ŒãŸéŸ³å£°ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆéŸ³å£°ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚`);
          // æ—¥æœ¬èªéŸ³å£°ã‚’æ¤œç´¢
          const jaVoice = voices.find(v => v.lang === 'ja-JP');
          if (jaVoice) {
            utterance.voice = jaVoice;
            console.log(`[playVoiceMessage] ä»£æ›¿éŸ³å£°: ${jaVoice.name}`);
          }
        }
        
        // éŸ³å£°åˆæˆã‚¤ãƒ™ãƒ³ãƒˆ
        utterance.onstart = () => {
          console.log(`[playVoiceMessage] âœ“ éŸ³å£°å†ç”Ÿé–‹å§‹`);
        };
        
        utterance.onend = () => {
          console.log(`[playVoiceMessage] âœ“ éŸ³å£°å†ç”Ÿå®Œäº†`);
        };
        
        utterance.onerror = (event) => {
          console.error(`[playVoiceMessage] éŸ³å£°å†ç”Ÿã‚¨ãƒ©ãƒ¼:`, event.error);
        };
        
        // éŸ³å£°ã‚’å†ç”Ÿ
        speechSynthesis.speak(utterance);
        console.log(`[playVoiceMessage] speechSynthesis.speak() å‘¼ã³å‡ºã—å®Œäº†`);
        
      } catch (e) {
        console.error('[playVoiceMessage] ã‚¨ãƒ©ãƒ¼:', e);
      }
    }

    // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¨­å®š
    document.addEventListener('DOMContentLoaded', () => {
      ['showCurrencies', 'showRecommended', 'show15m', 'show1H', 'show4H', 'showD', 'showAv'].forEach(id => {
        const checkbox = document.getElementById(id);
        if (checkbox) {
          checkbox.addEventListener('change', (e) => {
            displaySettings[id] = e.target.checked;
            if (window.currentData) renderStrengthData(window.currentData);
          });
        }
      });

      // è¨€èªåˆ‡æ›¿ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³
      ['langEn', 'langJa'].forEach(id => {
        const radio = document.getElementById(id);
        if (radio) {
          radio.addEventListener('change', (e) => {
            if (e.target.checked) {
              displaySettings.language = e.target.value;
              if (window.currentData) renderStrengthData(window.currentData);
            }
          });
        }
      });
    });
    // é€šè²¨ãƒšã‚¢ã®å®šç¾©ï¼ˆå®Ÿåœ¨ã™ã‚‹ãƒšã‚¢ã®ã¿ï¼‰
    const PAIR_DEFINITIONS = {
      'USDJPY': ['USD', 'JPY'],
      'EURUSD': ['EUR', 'USD'],
      'GBPUSD': ['GBP', 'USD'],
      'AUDUSD': ['AUD', 'USD'],
      'EURJPY': ['EUR', 'JPY'],
      'GBPJPY': ['GBP', 'JPY'],
      'AUDJPY': ['AUD', 'JPY'],
      'EURGBP': ['EUR', 'GBP'],
      'EURAUD': ['EUR', 'AUD'],
      'GBPAUD': ['GBP', 'AUD']
    };

    // é€šè²¨å¼·å¼±ã®è‰²åˆ†ã‘
    function getStrengthClass(score) {
      if (score <= -40) return 'very-weak';
      if (score <= -20) return 'weak';
      if (score <= 19) return 'neutral';
      if (score <= 39) return 'strong';
      return 'very-strong';
    }

    // æ¨å¥¨ãƒšã‚¢ã‚’è¨ˆç®—
    function calculateRecommendedPairs(currencies, rawScores) {
      const pairs = [];
      
      for (const [pair, [base, quote]] of Object.entries(PAIR_DEFINITIONS)) {
        const baseScore = rawScores[base] || 0;
        const quoteScore = rawScores[quote] || 0;
        const diff = Math.abs(baseScore - quoteScore);
        
        // å·®ãŒå°ã•ã„ï¼ˆãƒ¬ãƒ³ã‚¸ï¼‰ã¯ã‚¹ã‚­ãƒƒãƒ—
        if (diff < 20) continue;
        
        let direction, displayPair;
        if (baseScore > quoteScore) {
          // ãƒ™ãƒ¼ã‚¹é€šè²¨ãŒå¼·ã„ = è²·ã„
          direction = 'buy';
          displayPair = pair;
        } else {
          // ã‚¯ã‚©ãƒ¼ãƒˆé€šè²¨ãŒå¼·ã„ = å£²ã‚Š
          direction = 'sell';
          displayPair = pair;
        }
        
        pairs.push({ pair: displayPair, base, quote, direction, score: Math.round(diff) });
      }
      
      // ã‚¹ã‚³ã‚¢é †ã«ã‚½ãƒ¼ãƒˆ
      pairs.sort((a, b) => b.score - a.score);
      
      return pairs.slice(0, 3);  // ä¸Šä½3ã¤
    }

    // ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤º
    function renderStrengthData(data) {
      try {
        console.log('[renderStrengthData] Starting render with data:', data);
        
        const container = document.getElementById('strengthData');
        if (!container) {
          console.error('[renderStrengthData] Container #strengthData not found!');
          return;
        }
        
        container.innerHTML = '';
        
        // ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ
        const table = document.createElement('div');
        table.className = 'strength-table-wrapper';
        
        const grid = document.createElement('div');
        grid.className = 'strength-table-grid';
        
        // ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œ
        const headerTime = document.createElement('div');
        headerTime.className = 'table-header';
        headerTime.textContent = 'æ™‚é–“';
        grid.appendChild(headerTime);
        
        if (displaySettings.showCurrencies) {
          const headerCurrencies = document.createElement('div');
          headerCurrencies.className = 'table-header-currencies';
          headerCurrencies.style.textAlign = 'center';
          headerCurrencies.style.letterSpacing = '0.05em';
          headerCurrencies.style.gridColumn = 'span 5'; // 5åˆ—åˆ†ã‚’ã‚«ãƒãƒ¼
          headerCurrencies.textContent = 'å¼±ã€€ã€€ã€€â—€ã€€ã€€ã€€â—€ã€€ã€€ã€€â—€ã€€ã€€ã€€â—€ã€€ã€€ã€€ä¸­ã€€ã€€ã€€â–¶ã€€ã€€ã€€â–¶ã€€ã€€ã€€â–¶ã€€ã€€ã€€â–¶ã€€ã€€ã€€å¼·';
          grid.appendChild(headerCurrencies);
        }
        
        if (displaySettings.showRecommended) {
          const headerRecommended = document.createElement('div');
          headerRecommended.className = 'table-header-recommended';
          headerRecommended.textContent = 'æ¨å¥¨ãƒšã‚¢';
          grid.appendChild(headerRecommended);
        }
        
        console.log('[renderStrengthData] Headers created');
        
        // ãƒ‡ãƒ¼ã‚¿è¡Œ
      const timeframes = [
        { key: '15m', id: 'show15m' },
        { key: '1H', id: 'show1H' },
        { key: '4H', id: 'show4H' },
        { key: 'D', id: 'showD' },
        { key: 'Av', id: 'showAv' }
      ];
      
      timeframes.forEach(tf => {
        if (!displaySettings[tf.id] || !data[tf.key]) return;
        
        const tfData = data[tf.key];
        const currencies = tfData.currencies; // ã™ã§ã«ã‚½ãƒ¼ãƒˆæ¸ˆã¿ï¼ˆå¼±â†’å¼·ï¼‰
        const rawScores = tfData.raw_scores;
        const recommendedPairs = calculateRecommendedPairs(currencies, rawScores);
        
        // ğŸ”” å¤‰æ›´æ¤œå‡ºï¼šæœ€å¼±ã¨æœ€å¼·ã‚’ãƒã‚§ãƒƒã‚¯
        if (currencies && currencies.length > 0 && voiceNotificationSettings.notify[tf.key]) {
          const currentWeakest = currencies[0].currency;  // æœ€å¼±
          const currentStrongest = currencies[currencies.length - 1].currency;  // æœ€å¼·
          const prevState = previousExtreme[tf.key] || {};
          
          console.log(`[${tf.key}] é€šçŸ¥ãƒã‚§ãƒƒã‚¯: æœ€å¼±=${currentWeakest}, æœ€å¼·=${currentStrongest}`);
          
          // å‰å›ã®çŠ¶æ…‹ãŒãªã„å ´åˆã¯åˆæœŸåŒ–
          if (!prevState.weakest) {
            console.log(`[${tf.key}] åˆå›åˆæœŸåŒ–: weakest=${currentWeakest}, strongest=${currentStrongest}`);
            previousExtreme[tf.key] = {
              weakest: currentWeakest,
              strongest: currentStrongest
            };
          } else {
            // æœ€å¼±ãŒå¤‰æ›´ã•ã‚ŒãŸã‹ã€æœ€å¼·ãŒå¤‰æ›´ã•ã‚ŒãŸã‹ç¢ºèª
            const weakestChanged = prevState.weakest !== currentWeakest;
            const strongestChanged = prevState.strongest !== currentStrongest;
            
            console.log(`[${tf.key}] å¤‰æ›´æ¤œå‡º: weakest ${prevState.weakest}â†’${currentWeakest} (${weakestChanged}), strongest ${prevState.strongest}â†’${currentStrongest} (${strongestChanged})`);
            
            if (weakestChanged || strongestChanged) {
              // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆã—ã¦é€šçŸ¥ã‚’ç™ºç«
              let message = voiceNotificationSettings.customMessages[tf.key] || `${tf.key}ã®é€šè²¨å¼·å¼±ãŒå¤‰æ›´ã•ã‚Œã¾ã—ãŸã€‚`;
              
              // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ã‚’å«ã‚ã¦ã„ãªã„ã‹ç¢ºèª
              if (message.includes('[WEAKEST]') || message.includes('[STRONGEST]')) {
                message = message
                  .replace('[WEAKEST]', currentWeakest)
                  .replace('[STRONGEST]', currentStrongest);
              }
              
              console.log(`[${tf.key}] ğŸ”” é€šçŸ¥ç™ºç«: "${message}"`);
              playNotificationSound(tf.key, message);
              
              // çŠ¶æ…‹ã‚’æ›´æ–°
              previousExtreme[tf.key] = {
                weakest: currentWeakest,
                strongest: currentStrongest
              };
            }
          }
        }
        
        // æ™‚é–“è¶³ãƒ©ãƒ™ãƒ«
        const labelCell = document.createElement('div');
        labelCell.className = 'table-row-label';
        labelCell.textContent = tf.key;
        grid.appendChild(labelCell);
        
        // é€šè²¨ã‚»ãƒ«ï¼ˆ5é€šè²¨ã€ã‚½ãƒ¼ãƒˆæ¸ˆã¿ï¼‰
        if (displaySettings.showCurrencies) {
          // 5é€šè²¨ã‚’ä¿è¨¼ï¼ˆãƒ‡ãƒ¼ã‚¿ãŒä¸è¶³ã—ã¦ã„ã¦ã‚‚5ã‚»ãƒ«ä½œæˆï¼‰
          const currencyCount = 5;
          for (let i = 0; i < currencyCount; i++) {
            const cell = document.createElement('div');
            
            if (i < currencies.length) {
              // ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹å ´åˆ
              const item = currencies[i];
              cell.className = 'table-cell ' + getStrengthClass(item.score);
              
              // raw score ã‚’ä½¿ã£ã¦ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ % ã‚’è¨ˆç®—ï¼ˆdisplaySettings ã«å¾“ã†ï¼‰
              const rawScore = item.score || 0;
              let percentage = 0;
              const denom = (displaySettings.currencyNormalizationBase && displaySettings.currencyNormalizationBase > 0) ? displaySettings.currencyNormalizationBase : 350;
              percentage = Math.round((rawScore / denom) * 100);

              // ã‚¯ãƒªãƒƒãƒ—ï¼ˆè¡¨ç¤ºä¸Šï¼‰: ç”Ÿã‚¹ã‚³ã‚¢ãŒé–¾å€¤ã‚’è¶…ãˆãŸã‚‰ Â±100% ã«ã™ã‚‹
              if (displaySettings.clipEnabled && Math.abs(rawScore) > (displaySettings.clipThreshold || 350)) {
                percentage = rawScore >= 0 ? 100 : -100;
              }

              const percentText = percentage >= 0 ? `+${String(percentage).padStart(2, '0')}` : `-${String(Math.abs(percentage)).padStart(2, '0')}`;
              const scoreText = rawScore >= 0 ? `+${String(rawScore).padStart(3, '0')}` : `-${String(Math.abs(rawScore)).padStart(3, '0')}`;

              cell.textContent = `${getCurrencyLabel(item.currency)} ${percentText}% [${scoreText}]`;
              cell.title = `${item.currency} (${getCurrencyLabel(item.currency)}) score:${rawScore}`;
            } else {
              // ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆï¼ˆç©ºã‚»ãƒ«ï¼‰
              cell.className = 'table-cell';
              cell.textContent = '-';
              cell.style.opacity = '0.3';
            }
            
            grid.appendChild(cell);
          }
        }
        
        // æ¨å¥¨ãƒšã‚¢ã‚»ãƒ«ï¼ˆ1è¡Œè¡¨ç¤ºï¼‰
        if (displaySettings.showRecommended) {
          const pairCell = document.createElement('div');
          pairCell.className = 'table-recommended';
        
        recommendedPairs.forEach(pairInfo => {
          const pairSpan = document.createElement('span');
          pairSpan.className = 'recommended-pair';
          
          const pairName = document.createElement('span');
          pairName.style.fontWeight = 'bold';
          pairName.style.color = '#fff';
          pairName.textContent = getPairLabel(pairInfo.base, pairInfo.quote);
          pairSpan.appendChild(pairName);
          
          const dirBadge = document.createElement('span');
          dirBadge.className = pairInfo.direction === 'buy' ? 'buy-badge' : 'sell-badge';
          dirBadge.textContent = pairInfo.direction === 'buy' ? 'è²·â†‘' : 'å£²â†“';
          pairSpan.appendChild(dirBadge);
          
          // pair % ã¯ displaySettings.pairNormalizationBase ã‚’ä½¿ç”¨
          const pairDenom = (displaySettings.pairNormalizationBase && displaySettings.pairNormalizationBase > 0) ? displaySettings.pairNormalizationBase : 700;
          let percentage = Math.round((pairInfo.score / pairDenom) * 100);
          percentage = Math.max(-100, Math.min(100, percentage)); // è¡¨ç¤ºä¸Šã¯ã‚¯ãƒªãƒƒãƒ—
          const percentText = percentage >= 0 ? `+${String(percentage).padStart(2, '0')}` : `-${String(Math.abs(percentage)).padStart(2, '0')}`;
          
          const scoreSpan = document.createElement('span');
          scoreSpan.style.color = '#ffd700';
          scoreSpan.style.fontWeight = 'bold';
          scoreSpan.textContent = `${percentText}%[${pairInfo.score}]`;
          pairSpan.appendChild(scoreSpan);
          
          pairCell.appendChild(pairSpan);
        });
        
        grid.appendChild(pairCell);
        }
      });
      
      // grid-template-columnsã‚’å‹•çš„ã«èª¿æ•´ï¼ˆæ—¥æœ¬èªæ™‚ã¯ã‚»ãƒ«å¹…ã‚’æ‹¡å¼µï¼‰
      const isJa = displaySettings.language === 'ja';
      const currencyColW = isJa ? 'minmax(88px, 1fr)' : '1fr';
      const recColW = isJa ? '3fr' : '2fr';
      let columns = '50px'; // æ™‚é–“åˆ—
      if (displaySettings.showCurrencies && displaySettings.showRecommended) {
        // ä¸¡æ–¹è¡¨ç¤º: æ™‚é–“ + é€šè²¨5åˆ— + æ¨å¥¨ãƒšã‚¢
        columns += ` repeat(5, ${currencyColW}) ${recColW}`;
      } else if (displaySettings.showCurrencies) {
        // é€šè²¨ã®ã¿: æ™‚é–“ + é€šè²¨5åˆ—
        columns += ` repeat(5, ${currencyColW})`;
      } else if (displaySettings.showRecommended) {
        // æ¨å¥¨ãƒšã‚¢ã®ã¿: æ™‚é–“ + æ¨å¥¨ãƒšã‚¢
        columns += ` ${recColW}`;
      }
      grid.style.gridTemplateColumns = columns;
      
      console.log('[renderStrengthData] Grid template columns:', columns);
      
      table.appendChild(grid);
      container.appendChild(table);
      
      console.log('[renderStrengthData] Render complete. Container children:', container.children.length);
      
      } catch (error) {
        console.error('[renderStrengthData] ERROR during render:', error);
        console.error('[renderStrengthData] Stack trace:', error.stack);
        const container = document.getElementById('strengthData');
        if (container) {
          container.innerHTML = '<div style="color: red; padding: 20px;">ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚¨ãƒ©ãƒ¼: ' + error.message + '</div>';
        }
      }
    }

    // ãƒ‡ãƒ¼ã‚¿å–å¾—
    async function loadCurrencyStrength() {
      try {
        document.getElementById('loadingText').textContent = 'èª­ã¿è¾¼ã¿ä¸­...';
        
        // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ãŸã‚ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã‚’è¿½åŠ 
        const timestamp = new Date().getTime();
        const response = await fetch(`/api/currency_strength?_=${timestamp}`);
        const result = await response.json();
        
        if (result.status === 'success') {
          console.log('[CURRENCY_STRENGTH] Data received:', result.data);
          window.currentData = result.data; // ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
          renderStrengthData(result.data);
          
          // æ›´æ–°æ™‚åˆ»ã‚’è¡¨ç¤ºï¼ˆã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰è¿”ã•ã‚ŒãŸæ™‚åˆ»ã‚’ä½¿ç”¨ï¼‰
          let timeStr;
          if (result.data.last_updated) {
            // ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰è¿”ã•ã‚ŒãŸæ™‚åˆ»ã‚’ä½¿ç”¨ï¼ˆå½¢å¼: 2026-01-30 09:00:41ï¼‰
            timeStr = result.data.last_updated;
          } else {
            // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼šç¾åœ¨æ™‚åˆ»ã‚’ä½¿ç”¨
            const now = new Date();
            timeStr = now.toLocaleTimeString('ja-JP');
          }
          document.getElementById('loadingText').textContent = 'âœ“ æ›´æ–°å®Œäº†';
          document.getElementById('updateTime').textContent = `æœ€çµ‚æ›´æ–°: ${timeStr}`;
          // ã‚µãƒ¼ãƒãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¡¨ç¤ºï¼ˆãƒ‡ãƒ—ãƒ­ã‚¤ç¢ºèªç”¨ï¼‰
          if (result.data.server_version) {
            document.getElementById('serverVersion').textContent = `[v: ${result.data.server_version}]`;
          }
          
          setTimeout(() => {
            document.getElementById('loadingText').textContent = '';
          }, 2000);
        } else {
          document.getElementById('loadingText').textContent = 'âŒ ã‚¨ãƒ©ãƒ¼: ' + result.msg;
        }
      } catch (e) {
        console.error('[CURRENCY_STRENGTH] Error loading currency strength:', e);
        document.getElementById('loadingText').textContent = 'âŒ é€šä¿¡ã‚¨ãƒ©ãƒ¼';
      }
    }

    // 60ç§’ã”ã¨ã«è‡ªå‹•ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ï¼ˆSocket.IOã®è£œå®Œï¼‰
    setInterval(loadCurrencyStrength, 60000);

    // Socket.IOæ¥ç¶šã¨ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°
    const socket = io();
    
    socket.on('connect', () => {
      console.log('[SOCKET.IO] âœ“ Connected to server');
    });
    
    socket.on('disconnect', () => {
      console.log('[SOCKET.IO] âœ— Disconnected from server');
    });
    
    // Webhookå—ä¿¡æ™‚ã®é€šè²¨å¼·å¼±æ›´æ–°
    socket.on('currency_strength_update', (payload) => {
      console.log('[SOCKET.IO] Currency strength update received:', payload);
      
      if (payload.status === 'success' && payload.data) {
        window.currentData = payload.data;
        renderStrengthData(payload.data);
        
        // å¤‰æ›´å±¥æ­´ã‚’æ›´æ–°ï¼ˆã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰å–å¾—ï¼‰
        renderChangeHistory();
        
        // æ›´æ–°æ™‚åˆ»ã‚’è¡¨ç¤ºï¼ˆã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰è¿”ã•ã‚ŒãŸæ™‚åˆ»ã‚’ä½¿ç”¨ï¼‰
        let timeStr;
        if (payload.data.last_updated) {
          // ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰è¿”ã•ã‚ŒãŸæ™‚åˆ»ã‚’ä½¿ç”¨
          timeStr = payload.data.last_updated;
        } else if (payload.timestamp) {
          // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼špayload.timestampã‚’ä½¿ç”¨
          const updateTime = new Date(payload.timestamp);
          timeStr = updateTime.toLocaleTimeString('ja-JP');
        } else {
          // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼šç¾åœ¨æ™‚åˆ»
          const now = new Date();
          timeStr = now.toLocaleTimeString('ja-JP');
        }
        document.getElementById('loadingText').textContent = 'âœ“ æ›´æ–°å®Œäº†';
        document.getElementById('updateTime').textContent = `æœ€çµ‚æ›´æ–°: ${timeStr}`;
        if (payload.data.server_version) {
          document.getElementById('serverVersion').textContent = `[v: ${payload.data.server_version}]`;
        }
        
        setTimeout(() => {
          document.getElementById('loadingText').textContent = '';
        }, 2000);
      }
    });
    
    // åˆæœŸåŒ–å‡¦ç†
    async function initCurrencyStrength() {
      console.log('[CURRENCY_STRENGTH] Initializing...');
      
      // é›»å­éŸ³ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆã‚’å–å¾—
      await populateChimeFiles();
      
      // ä¿å­˜ã•ã‚ŒãŸè¨­å®šã‚’èª­ã¿è¾¼ã¿
      loadSettings();
      
      // å¤‰æ›´å±¥æ­´ã‚’è¡¨ç¤º
      renderChangeHistory();
      
      // ä¿å­˜ãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ 
      const saveBtn = document.getElementById('saveSettings');
      if (saveBtn) {
        saveBtn.addEventListener('click', saveSettings);
        console.log('[INIT] ä¿å­˜ãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ ');
      }
      
      // ã‚ºãƒ¼ãƒ ã‚»ãƒ¬ã‚¯ãƒˆã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ 
      const zoomSelect = document.getElementById('zoomLevel');
      if (zoomSelect) {
        zoomSelect.addEventListener('change', (e) => {
          applyZoom(e.target.value);
        });
        console.log('[INIT] ã‚ºãƒ¼ãƒ ã‚»ãƒ¬ã‚¯ãƒˆã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ ');
      }

      // è¡¨ç¤ºè¨­å®š: æ­£è¦åŒ– / ã‚¯ãƒªãƒƒãƒ—å…¥åŠ›ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ 
      const currencyNormInput = document.getElementById('currencyNormBase');
      const pairNormInput = document.getElementById('pairNormBase');
      const clipCheckbox = document.getElementById('clipEnabled');
      const clipThresholdInput = document.getElementById('clipThreshold');

      if (currencyNormInput) {
        currencyNormInput.addEventListener('change', (e) => {
          const v = Number(e.target.value) || displaySettings.currencyNormalizationBase;
          displaySettings.currencyNormalizationBase = Math.max(1, Math.min(displaySettings.currencyMaxTheoretical, v));
          if (window.currentData) renderStrengthData(window.currentData);
        });
      }
      if (pairNormInput) {
        pairNormInput.addEventListener('change', (e) => {
          const v = Number(e.target.value) || displaySettings.pairNormalizationBase;
          displaySettings.pairNormalizationBase = Math.max(1, Math.min(displaySettings.pairMaxTheoretical, v));
          if (window.currentData) renderStrengthData(window.currentData);
        });
      }
      if (clipCheckbox) {
        clipCheckbox.addEventListener('change', (e) => {
          displaySettings.clipEnabled = !!e.target.checked;
          if (window.currentData) renderStrengthData(window.currentData);
        });
      }
      if (clipThresholdInput) {
        clipThresholdInput.addEventListener('change', (e) => {
          const v = Number(e.target.value) || displaySettings.clipThreshold;
          displaySettings.clipThreshold = Math.max(1, Math.min(displaySettings.currencyMaxTheoretical, v));
          if (window.currentData) renderStrengthData(window.currentData);
        });
      }

      console.log('[INIT] è¡¨ç¤ºè¨­å®šç”¨ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠã‚’è¿½åŠ ');
      
      // åˆå›ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ï¼ˆãã®å¾Œã¯Socket.IOã§è‡ªå‹•æ›´æ–°ï¼‰
      loadCurrencyStrength();
      
      console.log('[INIT] åˆæœŸåŒ–å®Œäº† - ä»¥é™ã¯Webhookå—ä¿¡æ™‚ã«è‡ªå‹•æ›´æ–°ã•ã‚Œã¾ã™');
    }
    
    // åˆå›èª­ã¿è¾¼ã¿
    initCurrencyStrength();
  </script>
</body>
</html>
